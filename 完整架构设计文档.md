# Barca AI角色扮演系统 - 完整架构设计文档

## 项目概述

Barca 是一个基于 Spring Cloud 微服务架构的 AI 对话系统，支持文本和语音交互，具备角色扮演、会话管理、语音合成等核心功能。系统采用现代化的微服务设计理念，提供高可用、可扩展的 AI 对话服务。

## 团队分工

| 角色 | 负责人 | 主要职责 |
|------|--------|----------|
| AI工程师 | 米瑞林，贺辰飞 | • AI模型集成与优化<br>• 语音识别(ASR)服务开发<br>• 语音合成(TTS)服务开发<br>• AI对话逻辑实现<br>• 角色人设设计 |
| 前端工程师 | 王静 | • Vue.js 3前端开发<br>• 用户界面设计与实现<br>• 语音交互功能<br>• 状态管理(Pinia)<br>• 响应式设计 |
| 后端工程师 | 米芮林 | • Spring Cloud微服务架构<br>• API接口设计与实现<br>• 服务注册与发现(Eureka)<br>• API网关(Gateway)<br>• 业务逻辑处理 |

### 项目目标
- 提供流畅的 AI 对话体验
- 支持多模态交互（文本+语音）
- 实现角色扮演和个性化对话
- 构建高可用的微服务架构
- 支持水平扩展和负载均衡

### 核心特性
- **多模态交互**: 支持文本输入和语音输入
- **角色扮演**: 支持不同角色的人设对话
- **会话管理**: 完整的对话上下文维护
- **语音合成**: AI 回复支持语音播放
- **微服务架构**: 高可用、可扩展的服务设计
- **实时响应**: 低延迟的对话体验

## 系统整体架构

### 完整架构图
```
┌─────────────────────────────────────────────────────────────────┐
│                        前端应用层 (Frontend)                      │
├─────────────────────────────────────────────────────────────────┤
│  Vue.js 3 + Vite + Pinia + Vue Router                          │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │   Home.vue  │ │   Chat.vue  │ │  Components │ │   Utils     │ │
│  │   (首页)     │ │   (聊天)    │ │   (组件)    │ │   (工具)    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │  Stores     │ │  Services   │ │   Styles    │ │   Assets    │ │
│  │  (状态管理)  │ │  (API服务)  │ │   (样式)    │ │   (资源)    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    后端微服务层 (Backend Services)                │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐ │
│  │  Eureka Server  │    │  Gateway Server │    │ Provider Service │ │
│  │   (服务注册)     │    │   (API网关)     │    │   (业务服务)     │ │
│  │   Port: 8761    │    │   Port: 8080    │    │   Port: 8082    │ │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    AI服务集成层 (AI Integration)                  │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │ Chat Client │ │ ASR Client  │ │ TTS Client  │ │ AI Server   │ │
│  │ (AI对话)    │ │ (语音识别)  │ │ (语音合成)  │ │ (Python)    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 前端架构详解

### 技术栈
- **Vue.js 3**: 渐进式JavaScript框架
- **Vite**: 现代化构建工具
- **Pinia**: 状态管理库
- **Vue Router**: 路由管理
- **Axios**: HTTP客户端
- **SCSS**: CSS预处理器
- **@vueuse/core**: Vue组合式API工具库

### 前端模块结构
```
frontend/
├── src/
│   ├── components/          # 可复用组件
│   │   └── PlaceholderImage.vue
│   ├── views/               # 页面组件
│   │   ├── Home.vue         # 首页 - 角色选择
│   │   └── Chat.vue         # 聊天页面
│   ├── stores/              # 状态管理
│   │   ├── characters.js    # 角色状态管理
│   │   └── chat.js          # 聊天状态管理
│   ├── services/            # API服务
│   │   └── api.js           # API封装
│   ├── utils/               # 工具函数
│   │   ├── voiceChat.js     # 语音聊天工具
│   │   └── serverCheck.js   # 服务器检查
│   ├── styles/              # 样式文件
│   │   ├── main.scss        # 主样式
│   │   └── variables.scss   # 样式变量
│   ├── images/              # 图片资源
│   ├── App.vue              # 根组件
│   └── main.js              # 入口文件
├── public/                  # 静态资源
├── package.json             # 依赖配置
└── vite.config.js          # Vite配置
```

### 核心组件分析

#### 1. Home.vue (首页组件)
**功能**:
- 角色展示和选择
- 搜索和分类过滤
- 在线状态显示
- 路由跳转到聊天页面

**核心特性**:
- 响应式角色网格布局
- 实时搜索和过滤
- 角色在线状态管理
- 优雅的UI动画效果

#### 2. Chat.vue (聊天组件)
**功能**:
- 实时聊天界面
- 文本和语音消息处理
- 消息历史管理
- 语音播放控制

**核心特性**:
- 消息分组显示（按时间）
- 语音录制和播放
- 实时打字指示器
- 消息类型转换（文字↔语音）

#### 3. 状态管理 (Stores)

##### characters.js (角色状态)
```javascript
export const useCharacterStore = defineStore('characters', {
  state: () => ({
    characters: [...], // 角色数据
    searchQuery: '',   // 搜索关键词
    selectedCategory: 'all', // 选中分类
    characterOnlineStatus: {} // 在线状态
  }),
  
  getters: {
    filteredCharacters: (state) => {
      // 角色过滤和排序逻辑
    }
  },
  
  actions: {
    setSearchQuery(query) { ... },
    setSelectedCategory(category) { ... },
    getCharacterById(id) { ... }
  }
})
```

##### chat.js (聊天状态)
```javascript
export const useChatStore = defineStore('chat', {
  state: () => ({
    conversations: {}, // 按角色分组的对话记录
    isTyping: false,    // 打字状态
    isRecording: false, // 录音状态
    isPlaying: false,   // 播放状态
    currentCharacterId: null, // 当前角色ID
    currentSessionId: null    // 当前会话ID
  }),
  
  actions: {
    addMessage(message) { ... },
    generateAIResponse(character, userMessage) { ... },
    sendMessageToAPI(message, isAudio) { ... }
  }
})
```

#### 4. API服务 (services/api.js)

**核心功能**:
- HTTP请求封装
- 请求/响应拦截器
- 错误处理
- 会话管理API
- 媒体处理API

**主要API接口**:
```javascript
// 会话管理
export const sessionAPI = {
  sendTextMessage(sessionId, text),    // 发送文本消息
  sendAudioMessage(sessionId, audioFile) // 发送语音消息
}

#### 5. 语音工具 (utils/voiceChat.js)

**VoiceChatManager类**:
- 浏览器兼容性检查
- 麦克风权限管理
- 音频录制和播放
- 语音识别和合成
- 音量控制

**核心方法**:
```javascript
class VoiceChatManager {
  checkSupport()           // 检查浏览器支持
  startRecording()         // 开始录音
  stopRecording()          // 停止录音
  recognizeSpeech(audioBlob) // 语音识别
  playAudio(audioUrl)      // 播放音频
}
```

### 前端数据流

#### 1. 角色选择流程
```
用户访问首页 → 加载角色列表 → 搜索/过滤 → 选择角色 → 创建会话 → 跳转聊天页面
```

#### 2. 聊天交互流程
```
用户输入 → 状态更新 → API调用 → 后端处理 → 响应返回 → UI更新 → 语音播放
```

#### 3. 语音交互流程
```
用户录音 → 音频处理 → ASR识别 → 文本发送 → AI回复 → TTS合成 → 音频播放
```

## 后端架构详解

### 技术栈

#### 核心框架
- **Spring Boot**: 2.3.12 - 微服务基础框架
- **Spring Cloud**: Hoxton.SR12 - 微服务全家桶
- **Spring Web**: RESTful API 开发

#### 微服务组件
- **Netflix Eureka**: 服务注册与发现
- **OpenFeign**: 声明式 HTTP 客户端
- **Spring Cloud Gateway**: API 网关

#### 开发工具
- **Maven**: 3.x - 项目构建和依赖管理
- **Lombok**: 代码简化工具
- **Jackson**: JSON 序列化/反序列化（Spring Boot 内置）

#### 运行时环境
- **JDK**: 1.8
- **JVM**: HotSpot

### 后端模块结构
```
api-server/
├── eureka-server/          # 服务注册中心
│   ├── src/main/java/
│   │   └── org/qny/eurekaserver/
│   │       └── EurekaServerApplication.java
│   └── src/main/resources/
│       └── application.yml
├── gateway-server/          # API网关
│   ├── src/main/java/
│   │   └── org/qny/gatewayserver/
│   │       └── GatewayServerApplication.java
│   └── src/main/resources/
│       └── application.yml
├── provider/               # 业务服务
│   ├── src/main/java/
│   │   ├── ai/             # AI服务客户端
│   │   │   ├── AsrClient.java          # 语音识别客户端
│   │   │   ├── ChatClient.java         # AI对话客户端
│   │   │   └── TtsClient.java          # 语音合成客户端
│   │   ├── controller/     # 控制器层
│   │   │   ├── SessionController.java  # 会话控制器
│   │   │   └── MediaController.java    # 媒体控制器
│   │   ├── core/           # 核心业务逻辑
│   │   │   └── MemoryRepo.java         # 内存存储仓库
│   │   ├── dto/            # 数据传输对象
│   │   │   ├── MessageItem.java        # 消息项
│   │   │   ├── SendMessageResponse.java# 发送消息响应
│   │   │   ├── CreateSessionRequest.java# 创建会话请求
│   │   │   └── ...
│   │   └── ProviderApplication.java    # 应用启动类
│   └── src/main/resources/
│       └── application.yml
└── pom.xml                 # 父级POM配置
```

### 核心服务详解

#### 1. Eureka Server (服务注册中心)
**端口**: 8761  
**模块路径**: `eureka-server/`

##### 核心功能
- **服务注册**: 微服务实例注册
- **服务发现**: 客户端服务发现
- **健康检查**: 服务健康状态监控
- **负载均衡**: 服务实例负载均衡
- **故障转移**: 服务实例故障检测

##### 技术实现
```java
@SpringBootApplication
@EnableEurekaServer
public class EurekaServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(EurekaServerApplication.class, args);
    }
}
```

##### 配置详情
```yaml
server:
  port: 8761
eureka:
  client:
    fetch-registry: false          # 不获取注册表
    register-with-eureka: false    # 不注册自己
    service-url:
      defaultZone: http://localhost:8761/eureka/
  instance:
    prefer-ip-address: true        # 使用IP地址
```

##### 监控端点
- **健康检查**: `http://localhost:8761/actuator/health`
- **服务列表**: `http://localhost:8761/`
- **应用信息**: `http://localhost:8761/actuator/info`

#### 2. Gateway Server (API网关)
**端口**: 8080 (默认)  
**模块路径**: `gateway-server/`

##### 核心功能
- **统一入口**: 所有外部请求的统一入口
- **路由转发**: 根据路径转发到对应服务
- **负载均衡**: 请求分发到多个服务实例
- **跨域处理**: CORS 跨域资源共享

##### 技术实现
```java
@SpringBootApplication
public class GatewayServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(GatewayServerApplication.class, args);
    }
}
```

##### 路由配置
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: provider-service
          uri: lb://provider
          predicates:
            - Path=/api/v1/**
          filters:
            - StripPrefix=1
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins: "*"
            allowedMethods: "*"
            allowedHeaders: "*"
```

#### 3. Provider Service (业务服务)
**端口**: 8082  
**模块路径**: `provider/`

##### 核心功能
- **会话管理**: 创建、维护、销毁会话
- **消息处理**: 文本和语音消息处理
- **AI服务集成**: 调用外部AI服务
- **多媒体处理**: 音频文件处理
- **角色管理**: AI角色配置和管理
- **历史记录**: 对话历史存储和检索

##### 服务注册
```yaml
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
  instance:
    prefer-ip-address: true
spring:
  application:
    name: provider
```

##### 外部服务配置
```yaml
ai:
  chat:
    base-url: http://127.0.0.1:8000
  asr:
    base-url: http://127.0.0.1:8000
  tts:
    base-url: http://127.0.0.1:8000
```

##### 性能配置
```yaml
feign:
  client:
    config:
      default:
        connectTimeout: 5000    # 连接超时
        readTimeout: 60000      # 读取超时
```

### 核心模块详解

#### 1. AI 服务客户端层 (`ai/`)

##### ChatClient (AI对话客户端)
```java
@FeignClient(name = "ai-chat", url = "${ai.chat.base-url}")
public interface ChatClient {
    @PostMapping("/v1/chat")
    ChatResponse chat(@RequestBody ChatRequest request);
    
    // 内部类定义
    @Data @AllArgsConstructor @NoArgsConstructor
    class ChatRequest {
        private String characterId;    // 角色ID
        private List<Message> messages; // 历史消息
    }
    
    @Data @AllArgsConstructor @NoArgsConstructor
    class Message {
        private String role;    // 角色：user/assistant
        private String content; // 消息内容
    }
    
    @Data @AllArgsConstructor @NoArgsConstructor
    class ChatResponse {
        private String text;    // AI回复文本
    }
}
```

**功能特点**:
- 支持角色扮演对话
- 历史上下文维护
- HTTP同步调用

##### AsrClient (语音识别客户端)
```java
@FeignClient(name = "ai-asr", url = "${ai.asr.base-url}")
public interface AsrClient {
    @PostMapping("/v1/asr")
    AsrResult asr(@RequestPart("audio") MultipartFile audio);
    
    @Data @AllArgsConstructor @NoArgsConstructor
    class AsrResult {
        private String text;    // 识别出的文本
    }
}
```

**功能特点**:
- 多格式音频支持 (mp3, wav, ogg等)
- MultipartFile 文件上传处理

##### TtsClient (语音合成客户端)
```java
@FeignClient(name = "ai-tts", url = "${ai.tts.base-url}")
public interface TtsClient {
    @PostMapping("/v1/tts")
    TtsResult tts(@RequestBody TtsRequest request);
    
    @Data @AllArgsConstructor @NoArgsConstructor
    class TtsRequest {
        private String text;    // 要合成的文本
        private String voice;   // 声音类型
    }
    
    @Data @AllArgsConstructor @NoArgsConstructor
    class TtsResult {
        private String audioData;    // Base64音频数据
        private String format;       // 音频格式
        private Integer duration;    // 音频时长(ms)
    }
}
```

#### 2. 控制器层 (`controller/`)

##### SessionController (会话控制器)
**主要接口**:
```java
@RestController
@RequestMapping("/api/v1/sessions")
public class SessionController {
    
    // 创建会话
    @PostMapping("/createSession")
    public String createSession(@RequestParam String characterId);
    
    // 发送文本消息
    @PostMapping("/{sessionId}/messages")
    public SendMessageResponse sendText(@PathVariable String sessionId, 
                                       @RequestBody SendTextRequest request);
    
    // 发送音频消息
    @PostMapping(value = "/{sessionId}/audio", consumes = MediaType.MULTIPART_FORM_DATA_VALUE)
    public SendMessageResponse sendAudio(@PathVariable String sessionId,
                                        @RequestPart("audio") MultipartFile audio);
}
```

**业务逻辑**:
1. **会话创建**: 生成UUID作为会话ID，绑定角色
2. **文本处理**: 保存用户消息 → 调用AI → 保存AI回复 → TTS合成
3. **音频处理**: ASR识别 → 文本处理流程 → 返回音频数据

##### MediaController (媒体控制器)
**功能**: 媒体文件处理
- 音频文件上传
- 图片文件处理
- 文件存储管理

#### 3. 核心业务层 (`core/`)

##### MemoryRepo (内存存储仓库)
```java
@Component
public class MemoryRepo {
    private final Map<String, String> sessionToCharacter = new HashMap<>();
    private final Map<String, List<MessageItem>> sessionMessages = new HashMap<>();
    
    // 核心方法
    public String createSession(String characterId);
    public Optional<String> getCharacterId(String sessionId);
    public void appendMessage(String sessionId, MessageItem message);
    public List<MessageItem> listMessages(String sessionId, int limit, String cursor);
    public static MessageItem msg(String role, String text, String audioUrl);
}
```

**存储策略**:
- **会话映射**: `sessionId -> characterId`
- **消息存储**: `sessionId -> List<MessageItem>`
- **内存存储**: HashMap实现，快速访问
- **数据持久化**: 当前为内存存储，重启后数据丢失

#### 4. 数据传输对象层 (`dto/`)

##### MessageItem (消息项)
```java
@Data @AllArgsConstructor @NoArgsConstructor @Builder
public class MessageItem {
    private String id;              // 消息唯一ID
    private String role;            // 角色：user/assistant/system
    private String text;            // 文本内容
    private String audioUrl;        // 音频URL (兼容性)
    private String audioData;       // Base64音频数据
    private String audioFormat;     // 音频格式：mp3/wav/ogg
    private Integer audioDuration;  // 音频时长(毫秒)
    private Instant time;           // 消息时间戳
}
```

##### SendMessageResponse (发送消息响应)
```java
@Data @AllArgsConstructor @NoArgsConstructor @Builder
public class SendMessageResponse {
    private MessageItem userMessage;        // 用户消息
    private MessageItem assistantMessage;   // AI助手消息
}
```

**设计特点**:
- 使用Builder模式，支持链式调用
- Lombok注解简化代码
- 支持多媒体内容
- 时间戳自动生成

## 核心功能模块

### 1. 会话管理 (Session Management)
**功能描述**:
- 创建会话
- 会话状态维护
- 消息历史记录
- 角色绑定

**API接口**:
```java
POST /api/v1/sessions/createSession?characterId={id}
```

**技术实现**:
- 使用内存存储 (`MemoryRepo`)
- 会话ID使用UUID生成
- 支持多会话并发

### 2. 文本对话 (Text Chat)
**功能描述**:
- 文本消息发送
- AI智能回复
- 上下文记忆
- 语音合成

**API接口**:
```java
POST /api/v1/sessions/{sessionId}/messages
```

**技术实现**:
- FeignClient调用AI服务
- 历史消息组装
- 异步TTS处理

### 3. 语音交互 (Voice Interaction)
**功能描述**:
- 语音输入识别
- 音频文件处理
- 语音回复生成
- 多媒体响应

**API接口**:
```java
POST /api/v1/sessions/{sessionId}/audio
```

**技术实现**:
- MultipartFile处理
- ASR → Chat → TTS 流程
- Base64音频数据返回

## 数据流程

### 文本对话流程
```
用户输入 → SessionController → MemoryRepo存储 → ChatClient → AI服务
    ↓
AI回复 ← ChatResponse ← 文本处理 ← 历史消息组装
    ↓
TTS处理 → 语音合成 → 返回完整响应
```

### 语音对话流程
```
音频上传 → ASR识别 → 文本提取 → ChatClient → AI服务
    ↓
AI回复 → TTS合成 → Base64音频 → 返回响应
```

## 外部服务集成

### AI Chat Service
- **协议**: HTTP REST API
- **端点**: `http://127.0.0.1:8000/v1/chat`
- **功能**: 智能对话生成

### ASR Service
- **协议**: HTTP REST API
- **端点**: `http://127.0.0.1:8000/v1/asr`
- **功能**: 语音转文本

### TTS Service
- **协议**: HTTP REST API
- **端点**: `http://127.0.0.1:8000/v1/tts`
- **功能**: 文本转语音

## 数据模型

### 前端数据模型

#### 角色模型 (Character)
```javascript
{
  id: 'harry-potter',           // 角色唯一标识
  name: '哈利·波特',            // 角色名称
  description: '来自霍格沃茨的年轻巫师', // 角色描述
  avatar: '/src/images/hallypotter.jpeg', // 头像路径
  background: '/src/images/hallypotter.jpeg', // 背景图
  category: '文学',             // 分类
  personality: '勇敢、善良、忠诚', // 性格特征
  voice: 'young-male',         // 声音类型
  prompt: '你是哈利·波特...',    // AI提示词
  isOnline: true               // 在线状态
}
```

#### 消息模型 (Message)
```javascript
{
  id: 'msg_1234567890',        // 消息唯一ID
  type: 'user' | 'ai',        // 消息类型
  content: '你好，哈利！',      // 消息内容
  timestamp: new Date(),       // 时间戳
  isVoice: false,             // 是否为语音消息
  audioUrl: 'blob:...',       // 音频URL
  audioData: 'base64...',     // Base64音频数据
  audioFormat: 'mp3',         // 音频格式
  audioDuration: 3000,        // 音频时长(ms)
  character: {...},           // 关联角色信息
  hasAudioData: true          // 是否有音频数据
}
```

### 后端数据模型

#### MessageItem (消息项)
```java
@Data @AllArgsConstructor @NoArgsConstructor @Builder
public class MessageItem {
    private String id;              // 消息唯一ID
    private String role;            // 角色：user/assistant/system
    private String text;            // 文本内容
    private String audioUrl;        // 音频URL (兼容性)
    private String audioData;       // Base64音频数据
    private String audioFormat;     // 音频格式：mp3/wav/ogg
    private Integer audioDuration;  // 音频时长(毫秒)
    private Instant time;           // 消息时间戳
}
```

#### SendMessageResponse (发送消息响应)
```java
@Data @AllArgsConstructor @NoArgsConstructor @Builder
public class SendMessageResponse {
    private MessageItem userMessage;        // 用户消息
    private MessageItem assistantMessage;   // AI助手消息
}
```

## API接口设计

### 前端API调用

#### 1. 会话管理
```javascript
// 创建会话
POST /api/v1/sessions?characterId=harry-potter

// 发送文本消息
POST /api/v1/sessions/{sessionId}/messages
{
  "text": "你好，哈利！"
}

// 发送语音消息
POST /api/v1/sessions/{sessionId}/audio
Content-Type: multipart/form-data
FormData: { audio: audioFile }
```


### 后端API响应

#### 文本消息响应
```json
{
  "userMessage": {
    "id": "user_msg_123",
    "role": "user",
    "text": "你好，哈利！",
    "time": "2024-01-01T12:00:00Z"
  },
  "assistantMessage": {
    "id": "ai_msg_124",
    "role": "assistant",
    "text": "你好！很高兴见到你！",
    "audioData": "base64_audio_data...",
    "audioFormat": "mp3",
    "audioDuration": 3000,
    "time": "2024-01-01T12:00:01Z"
  }
}
```

#### 语音消息响应
```json
{
  "userMessage": {
    "id": "user_msg_125",
    "role": "user",
    "text": "语音识别结果",
    "time": "2024-01-01T12:00:00Z"
  },
  "assistantMessage": {
    "id": "ai_msg_126",
    "role": "assistant",
    "text": "AI回复文本",
    "audioData": "base64_audio_data...",
    "audioFormat": "mp3",
    "audioDuration": 4000,
    "time": "2024-01-01T12:00:01Z"
  }
}
```

## 部署架构

### 开发环境
```
前端开发服务器:
- 本地: http://localhost:3000

后端微服务:
- Eureka Server: localhost:8761
- Gateway Server: localhost:8080
- Provider Service: localhost:8082
- AI Services: localhost:8000 (Python)
```

## 系统启动指南

### 环境要求
- **JDK**: 1.8+
- **Maven**: 3.x
- **Node.js**: 16.x+
- **Python**: 3.8+

### 启动顺序
系统需要按以下顺序启动各个服务：

```
1. AI服务 (Python) → 2. Eureka Server → 3. Provider Service → 4. Gateway Server → 5. 前端服务
```

### 1. AI服务启动 (Python)

**服务说明**: 提供AI对话、语音识别、语音合成功能

**启动步骤**:
```bash
# 进入AI服务目录
cd /path/to/ai_server

# 安装依赖
pip install -r requirements.txt

# 启动AI服务
python app/main.py
```

**验证启动**:
- 访问: `http://localhost:8000/health`
- 预期响应: `{"status": "ok"}`

**服务端口**: 8000

### 2. Eureka Server启动 (Java)

**服务说明**: 微服务注册中心，管理所有服务实例

**启动步骤**:
```bash
# 进入Eureka Server目录
cd /barca/api-server/eureka-server

# 编译项目
mvn clean compile

# 启动Eureka Server
mvn spring-boot:run
```

**验证启动**:
- 访问: `http://localhost:8761`
- 预期看到: Eureka服务注册页面

**服务端口**: 8761

### 3. Provider Service启动 (Java)

**服务说明**: 核心业务服务，处理会话管理和消息处理

**启动步骤**:
```bash
# 进入Provider Service目录
cd /barca/api-server/provider

# 编译项目
mvn clean compile

# 启动Provider Service
mvn spring-boot:run
```

**验证启动**:
- 检查Eureka控制台: `http://localhost:8761`
- 确认provider服务已注册
- 访问: `http://localhost:8082/actuator/health`

**服务端口**: 8082

### 4. Gateway Server启动 (Java)

**服务说明**: API网关，统一入口和路由转发

**启动步骤**:
```bash
# 进入Gateway Server目录
cd /barca/api-server/gateway-server

# 编译项目
mvn spring-boot:run
```

**验证启动**:
- 检查Eureka控制台: `http://localhost:8761`
- 确认gateway服务已注册
- 访问: `http://localhost:8080/actuator/health`

**服务端口**: 8080

### 5. 前端服务启动 (Vue.js)

**服务说明**: 用户界面，提供角色选择和聊天功能

**启动步骤**:
```bash
# 进入前端目录
cd /barca/frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

**验证启动**:
- 访问: `http://localhost:3000`
- 预期看到: AI角色扮演首页

**服务端口**: 3000


## 团队信息

**开发团队**:
- **AI工程师**: 米瑞林，贺辰飞 - 负责AI模型集成、语音处理服务开发
- **前端工程师**: 王静 - 负责Vue.js前端开发、用户界面设计
- **后端工程师**: 米芮林 - 负责Spring Cloud微服务架构、API开发

**项目特色**:
- 多模态AI交互体验
- 微服务架构设计
- 完整的语音处理流程
- 响应式用户界面
