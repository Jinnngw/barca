# AI角色扮演网站 - 架构设计文档

## 文档概述

### 文档目的
本文档描述了AI角色扮演网站的系统架构设计，包含模块规格、技术选型、分工职责等内容，重点阐述已实现的前端架构和待开发的后端架构。

### 项目背景
开发一个利用AI进行角色扮演的网页应用，用户可以选择感兴趣的角色（如哈利波特、苏格拉底等）并进行语音聊天，提供沉浸式的角色扮演体验。

## 前端架构设计

### 3.1 技术栈

**核心框架：**
- Vue 3 + Composition API
- Vue Router 4（路由管理）
- Pinia（状态管理）
- Vite（构建工具）

**样式系统：**
- SCSS（样式预处理器）
- 响应式设计（移动端适配）

**语音功能：**
- Web Speech API（语音识别和合成）
- MediaRecorder API（语音录制）

**UI组件：**
- 自定义组件库
- SVG图标系统
- 动画效果（CSS3 + Vue Transition）

### 3.2 模块规格

#### 3.2.1 角色管理模块
**功能描述**：
- 6个预设角色数据管理
- 按分类筛选（文学、哲学、科学）
- 关键词搜索功能
- 角色卡片展示
- 在线状态指示器

**技术实现**：
```javascript
// stores/characters.js
export const useCharacterStore = defineStore('characters', {
  state: () => ({
    characters: [], // 角色数据
    searchQuery: '', // 搜索关键词
    selectedCategory: 'all' // 选中分类
  }),
  getters: {
    filteredCharacters: (state) => { /* 过滤逻辑 */ },
    categories: (state) => { /* 分类列表 */ }
  },
  actions: {
    setSearchQuery(query) { /* 设置搜索 */ },
    setSelectedCategory(category) { /* 设置分类 */ }
  }
})
```

#### 3.2.2 聊天交互模块
**功能描述**：处理用户与AI角色的对话交互
- 消息列表管理
- 打字指示器动画
- 消息时间戳显示
- 对话气泡设计
- 自动滚动到底部

**技术实现**：
```javascript
// stores/chat.js
export const useChatStore = defineStore('chat', {
  state: () => ({
    messages: [], // 消息列表
    isTyping: false, // 打字状态
    isRecording: false, // 录音状态
    isPlaying: false // 播放状态
  }),
  actions: {
    addMessage(message) { /* 添加消息 */ },
    generateAIResponse(character, userMessage) { /* 生成AI回复 */ }
  }
})
```

#### 3.2.3 语音交互模块
**功能描述**：处理语音录制、播放、TTS功能
- 语音录制（MediaRecorder API）
- 语音播放（Web Speech API）
- 文本转语音（TTS）
- 语音消息显示
- 录音状态指示
- 播放控制按钮

**技术实现**：
```javascript
// utils/voiceChat.js
export class VoiceChatManager {
  constructor() {
    this.mediaRecorder = null
    this.audioChunks = []
    this.speechSynthesis = window.speechSynthesis
  }
  
  async startRecording() { /* 开始录音 */ }
  stopRecording() { /* 停止录音 */ }
  speakText(text, options) { /* 文本转语音 */ }
  playAudio(audioUrl) { /* 播放音频 */ }
}
```
#### 3.2.4 UI组件模块
**功能描述**：提供可复用的UI组件。
- 占位符图片组件
- 角色卡片组件
- 聊天界面组件
- 语音控制组件
- 响应式布局

**组件结构**：
```
src/components/
├── PlaceholderImage.vue    # 占位符图片组件
└── (其他组件...)

src/views/
├── Home.vue                # 首页
└── Chat.vue                # 聊天页面
```

### 3.3 数据流设计

#### 3.3.1 状态管理流程
```
用户操作 → Action → State更新 → Getter计算 → 组件响应
```

#### 3.3.2 组件通信
```
父组件 ←→ Props/Emit ←→ 子组件
组件 ←→ Pinia Store ←→ 组件
```

## 后端架构设计（待实现）


## 分工职责

### 5.1 团队分工

| 角色 | 负责人 | 主要职责 | 技术栈 |
|------|--------|----------|--------|
| **AI工程师** | 贺辰飞 |  |  |
| **前端工程师** | 王静 | Vue.js开发、UI/UX设计、语音交互 | Vue 3、Pinia、SCSS、Web APIs |
| **后端工程师** | 米芮林 |  |  |

### 5.2 详细分工

#### 5.2.1 前端工程师（王静）
**已完成工作**：
- Vue 3项目架构搭建
- 角色管理系统开发
- 聊天界面实现
- 语音交互功能开发
- UI组件库建设
- 响应式设计实现

**待完成工作**：
- 与后端API集成
- 错误处理优化
- 性能优化
- 用户体验优化

#### 5.2.2 AI工程师（贺辰飞）
**待完成工作**：


#### 5.2.3 后端工程师（米芮林）
**待完成工作**：


## 接口设计

### 6.1 前端API接口

#### 6.1.1 角色相关接口
```javascript
// 获取角色列表
GET /api/characters
Response: {
  characters: Character[],
  categories: string[]
}

// 获取角色详情
GET /api/characters/:id
Response: {
  id: string,
  name: string,
  description: string,
  avatar: string,
  background: string,
  category: string,
  personality: string
}
```

#### 6.1.2 对话相关接口
```javascript
// 发送消息
POST /api/conversations/:id/messages
Request: {
  content: string,
  type: 'text' | 'voice',
  audioData?: Blob
}
Response: {
  messageId: string,
  content: string,
  timestamp: Date,
  isVoice: boolean
}
```

### 6.2 数据模型

#### 6.2.1 角色模型
```javascript
interface Character {
  id: string
  name: string
  description: string
  avatar: string
  background: string
  category: string
  personality: string
  voice: string
  prompt: string
}
```

#### 6.2.2 消息模型
```javascript
interface Message {
  id: string
  conversationId: string
  userId: string
  characterId: string
  content: string
  type: 'user' | 'ai'
  isVoice: boolean
  audioUrl?: string
  timestamp: Date
}
```

## 部署架构

### 7.1 前端部署
- **构建工具**：Vite
- **部署方式**：静态文件部署
- **CDN**：静态资源加速
- **域名**：独立域名或子域名



## 性能指标

### 8.1 前端性能
- **首屏加载时间**：< 2秒
- **路由切换时间**：< 500ms
- **语音录制延迟**：< 100ms
- **TTS播放延迟**：< 1秒


## 安全设计

### 9.1 前端安全
- **XSS防护**：Vue内置防护
- **CSRF防护**：Token验证
- **内容安全**：用户输入过滤


---
